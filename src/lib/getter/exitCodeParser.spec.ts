import { parseExitCodes } from "./exitCodeParser";

const code =
  "OzsgTXVsdGlzaWcgVEYtYXV0aG9yaXplZCB3YWxsZXQKOzsgaHR0cHM6Ly9naXRodWIuY29tL3Rvbi1ibG9ja2NoYWluL211bHRpc2lnLWNvbnRyYWN0L2Jsb2IvbWFzdGVyL211bHRpc2lnLWNvZGUuZmMKOzsgZ2l0aHViLmNvbS9kZXZkYW90ZWFtIC8vIHQubWUveEpldFN3YXBCb3QgLy8gZ2l0aHViLmNvbS9kZWxweWRvYwoKXyB1bnBhY2tfc3RhdGUoKSBpbmxpbmVfcmVmIHsKICB2YXIgZHMgPSBiZWdpbl9wYXJzZShnZXRfZGF0YSgpKTsKICB2YXIgcmVzID0gKGRzfmxvYWRfdWludCgzMiksIGRzfmxvYWRfdWludCg4KSwgZHN+bG9hZF91aW50KDgpLCBkc35sb2FkX3VpbnQoNjQpLCBkc35sb2FkX2RpY3QoKSwgZHN+bG9hZF9kaWN0KCkpOwogIGRzLmVuZF9wYXJzZSgpOwogIHJldHVybiByZXM7Cn0KCl8gcGFja19zdGF0ZShjZWxsIHBlbmRpbmdfcXVlcmllcywgY2VsbCBvd25lcl9pbmZvcywgaW50IGxhc3RfY2xlYW5lZCwgaW50IGssIGludCBuLCBpbnQgd2FsbGV0X2lkKSBpbmxpbmVfcmVmIHsKICByZXR1cm4gYmVnaW5fY2VsbCgpCiAgICAuc3RvcmVfdWludCh3YWxsZXRfaWQsIDMyKQogICAgLnN0b3JlX3VpbnQobiwgOCkKICAgIC5zdG9yZV91aW50KGssIDgpCiAgICAuc3RvcmVfdWludChsYXN0X2NsZWFuZWQsIDY0KQogICAgLnN0b3JlX2RpY3Qob3duZXJfaW5mb3MpCiAgICAuc3RvcmVfZGljdChwZW5kaW5nX3F1ZXJpZXMpCiAgLmVuZF9jZWxsKCk7Cn0KCl8gcGFja19vd25lcl9pbmZvKGludCBwdWJsaWNfa2V5LCBpbnQgZmxvb2QpIGlubGluZV9yZWYgewogIHJldHVybiBiZWdpbl9jZWxsKCkKICAgIC5zdG9yZV91aW50KHB1YmxpY19rZXksIDI1NikKICAgIC5zdG9yZV91aW50KGZsb29kLCA4KTsKfQoKXyB1bnBhY2tfb3duZXJfaW5mbyhzbGljZSBjcykgaW5saW5lX3JlZiB7CiAgcmV0dXJuIChjc35sb2FkX3VpbnQoMjU2KSwgY3N+bG9hZF91aW50KDgpKTsKfQoKKGludCwgaW50KSBjaGVja19zaWduYXR1cmVzKGNlbGwgcHVibGljX2tleXMsIGNlbGwgc2lnbmF0dXJlcywgaW50IGhhc2gsIGludCBjbnRfYml0cykgaW5saW5lX3JlZiB7CiAgaW50IGNudCA9IDA7CgogIGRvIHsKICAgIHNsaWNlIGNzID0gc2lnbmF0dXJlcy5iZWdpbl9wYXJzZSgpOwogICAgc2xpY2Ugc2lnbmF0dXJlID0gY3N+bG9hZF9iaXRzKDUxMik7CgogICAgaW50IGkgPSBjc35sb2FkX3VpbnQoOCk7CiAgICBzaWduYXR1cmVzID0gY3N+bG9hZF9kaWN0KCk7CgogICAgKHNsaWNlIHB1YmxpY19rZXksIHZhciBmb3VuZD8pID0gcHVibGljX2tleXMudWRpY3RfZ2V0Pyg4LCBpKTsKICAgIHRocm93X3VubGVzcygzNywgZm91bmQ/KTsKICAgIHRocm93X3VubGVzcygzOCwgY2hlY2tfc2lnbmF0dXJlKGhhc2gsIHNpZ25hdHVyZSwgcHVibGljX2tleS5wcmVsb2FkX3VpbnQoMjU2KSkpOwoKICAgIGludCBtYXNrID0gKDEgPDwgaSk7CiAgICBpbnQgb2xkX2NudF9iaXRzID0gY250X2JpdHM7CiAgICBjbnRfYml0cyB8PSBtYXNrOwogICAgaW50IHNob3VsZF9jaGVjayA9IGNudF9iaXRzICE9IG9sZF9jbnRfYml0czsKICAgIGNudCAtPSBzaG91bGRfY2hlY2s7CiAgfSB1bnRpbCAoY2VsbF9udWxsPyhzaWduYXR1cmVzKSk7CgogIHJldHVybiAoY250LCBjbnRfYml0cyk7Cn0KCigpIHJlY3ZfaW50ZXJuYWwoc2xpY2UgaW5fbXNnKSBpbXB1cmUgewogIDs7IGRvIG5vdGhpbmcgZm9yIGludGVybmFsIG1lc3NhZ2VzCn0KCihpbnQsIGludCwgaW50LCBzbGljZSkgdW5wYWNrX3F1ZXJ5X2RhdGEoc2xpY2UgaW5fbXNnLCBpbnQgbiwgc2xpY2UgcXVlcnksIHZhciBmb3VuZD8sIGludCByb290X2kpIGlubGluZV9yZWYgewogIGlmIChmb3VuZD8pIHsKICAgIHRocm93X3VubGVzcygzNSwgcXVlcnl+bG9hZF9pbnQoMSkpOwogICAgKGludCBjcmVhdG9yX2ksIGludCBjbnQsIGludCBjbnRfYml0cywgc2xpY2UgbXNnKSA9IChxdWVyeX5sb2FkX3VpbnQoOCksIHF1ZXJ5fmxvYWRfdWludCg4KSwgcXVlcnl+bG9hZF91aW50KG4pLCBxdWVyeSk7CiAgICB0aHJvd191bmxlc3MoMzYsIHNsaWNlX2hhc2gobXNnKSA9PSBzbGljZV9oYXNoKGluX21zZykpOwogICAgcmV0dXJuIChjcmVhdG9yX2ksIGNudCwgY250X2JpdHMsIG1zZyk7CiAgfQogIHRocm93X3VubGVzcyg0Mywgc2xpY2VfcmVmcyhpbl9tc2cpICogOCA9PSBzbGljZV9iaXRzKGluX21zZykpOwogIHJldHVybiAocm9vdF9pLCAwLCAwLCBpbl9tc2cpOwp9CgooY2VsbCwgKCkpIGRlY19mbG9vZChjZWxsIG93bmVyX2luZm9zLCBpbnQgY3JlYXRvcl9pKSB7CiAgKHNsaWNlIG93bmVyX2luZm8sIHZhciBmb3VuZD8pID0gb3duZXJfaW5mb3MudWRpY3RfZ2V0Pyg4LCBjcmVhdG9yX2kpOwogIChpbnQgcHVibGljX2tleSwgaW50IGZsb29kKSA9IHVucGFja19vd25lcl9pbmZvKG93bmVyX2luZm8pOwogIG93bmVyX2luZm9zfnVkaWN0X3NldF9idWlsZGVyKDgsIGNyZWF0b3JfaSwgcGFja19vd25lcl9pbmZvKHB1YmxpY19rZXksIGZsb29kIC0gMSkpOwogIHJldHVybiAob3duZXJfaW5mb3MsICgpKTsKfQoKKCkgdHJ5X2luaXQoKSBpbXB1cmUgaW5saW5lX3JlZiB7CiAgOzsgZmlyc3QgcXVlcnkgd2l0aG91dCBzaWduYXR1cmVzIGlzIGFsd2F5cyBhY2NlcHRlZAogIChpbnQgd2FsbGV0X2lkLCBpbnQgbiwgaW50IGssIGludCBsYXN0X2NsZWFuZWQsIGNlbGwgb3duZXJfaW5mb3MsIGNlbGwgcGVuZGluZ19xdWVyaWVzKSA9IHVucGFja19zdGF0ZSgpOwogIHRocm93X2lmKDM3LCBsYXN0X2NsZWFuZWQpOwogIGFjY2VwdF9tZXNzYWdlKCk7CiAgc2V0X2RhdGEocGFja19zdGF0ZShwZW5kaW5nX3F1ZXJpZXMsIG93bmVyX2luZm9zLCAxLCBrLCBuLCB3YWxsZXRfaWQpKTsKfQoKKGNlbGwsIGNlbGwpIHVwZGF0ZV9wZW5kaW5nX3F1ZXJpZXMoY2VsbCBwZW5kaW5nX3F1ZXJpZXMsIGNlbGwgb3duZXJfaW5mb3MsIHNsaWNlIG1zZywgaW50IHF1ZXJ5X2lkLCBpbnQgY3JlYXRvcl9pLCBpbnQgY250LCBpbnQgY250X2JpdHMsIGludCBuLCBpbnQgaykgaW1wdXJlIGlubGluZV9yZWYgewogIGlmIChjbnQgPj0gaykgewogICAgYWNjZXB0X21lc3NhZ2UoKTsKICAgIHdoaWxlIChtc2cuc2xpY2VfcmVmcygpKSB7CiAgICAgIHZhciBtb2RlID0gbXNnfmxvYWRfdWludCg4KTsKICAgICAgc2VuZF9yYXdfbWVzc2FnZShtc2d+bG9hZF9yZWYoKSwgbW9kZSk7CiAgICB9CiAgICBwZW5kaW5nX3F1ZXJpZXN+dWRpY3Rfc2V0X2J1aWxkZXIoNjQsIHF1ZXJ5X2lkLCBiZWdpbl9jZWxsKCkuc3RvcmVfaW50KDAsIDEpKTsKICAgIG93bmVyX2luZm9zfmRlY19mbG9vZChjcmVhdG9yX2kpOwogIH0gZWxzZSB7CiAgICBwZW5kaW5nX3F1ZXJpZXN+dWRpY3Rfc2V0X2J1aWxkZXIoNjQsIHF1ZXJ5X2lkLCBiZWdpbl9jZWxsKCkKICAgICAgLnN0b3JlX3VpbnQoMSwgMSkKICAgICAgLnN0b3JlX3VpbnQoY3JlYXRvcl9pLCA4KQogICAgICAuc3RvcmVfdWludChjbnQsIDgpCiAgICAgIC5zdG9yZV91aW50KGNudF9iaXRzLCBuKQogICAgICAuc3RvcmVfc2xpY2UobXNnKSk7CiAgfQogIHJldHVybiAocGVuZGluZ19xdWVyaWVzLCBvd25lcl9pbmZvcyk7Cn0KCihpbnQsIGludCkgY2FsY19ib2Nfc2l6ZShpbnQgY2VsbHMsIGludCBiaXRzLCBzbGljZSByb290KSB7CiAgY2VsbHMgKz0gMTsKICBiaXRzICs9IHJvb3Quc2xpY2VfYml0cygpOwoKICB3aGlsZSAocm9vdC5zbGljZV9yZWZzKCkpIHsKICAgIChjZWxscywgYml0cykgPSBjYWxjX2JvY19zaXplKGNlbGxzLCBiaXRzLCByb290fmxvYWRfcmVmKCkuYmVnaW5fcGFyc2UoKSk7CiAgfQoKICByZXR1cm4gKGNlbGxzLCBiaXRzKTsKfQoKKCkgcmVjdl9leHRlcm5hbChzbGljZSBpbl9tc2cpIGltcHVyZSB7CiAgOzsgZW1wdHkgbWVzc2FnZSB0cmlnZ2VycyBpbml0CiAgaWYgKHNsaWNlX2VtcHR5Pyhpbl9tc2cpKSB7CiAgICByZXR1cm4gdHJ5X2luaXQoKTsKICB9CgogIDs7IENoZWNrIHJvb3Qgc2lnbmF0dXJlCiAgc2xpY2Ugcm9vdF9zaWduYXR1cmUgPSBpbl9tc2d+bG9hZF9iaXRzKDUxMik7CiAgaW50IHJvb3RfaGFzaCA9IHNsaWNlX2hhc2goaW5fbXNnKTsKICBpbnQgcm9vdF9pID0gaW5fbXNnfmxvYWRfdWludCg4KTsKCiAgKGludCB3YWxsZXRfaWQsIGludCBuLCBpbnQgaywgaW50IGxhc3RfY2xlYW5lZCwgY2VsbCBvd25lcl9pbmZvcywgY2VsbCBwZW5kaW5nX3F1ZXJpZXMpID0gdW5wYWNrX3N0YXRlKCk7CiAgbGFzdF9jbGVhbmVkIC09IGxhc3RfY2xlYW5lZCA9PSAwOwoKICAoc2xpY2Ugb3duZXJfaW5mbywgdmFyIGZvdW5kPykgPSBvd25lcl9pbmZvcy51ZGljdF9nZXQ/KDgsIHJvb3RfaSk7CiAgdGhyb3dfdW5sZXNzKDMxLCBmb3VuZD8pOwogIChpbnQgcHVibGljX2tleSwgaW50IGZsb29kKSA9IHVucGFja19vd25lcl9pbmZvKG93bmVyX2luZm8pOwogIHRocm93X3VubGVzcygzMiwgY2hlY2tfc2lnbmF0dXJlKHJvb3RfaGFzaCwgcm9vdF9zaWduYXR1cmUsIHB1YmxpY19rZXkpKTsKCiAgY2VsbCBzaWduYXR1cmVzID0gaW5fbXNnfmxvYWRfZGljdCgpOwoKICB2YXIgaGFzaCA9IHNsaWNlX2hhc2goaW5fbXNnKTsKICBpbnQgcXVlcnlfd2FsbGV0X2lkID0gaW5fbXNnfmxvYWRfdWludCgzMik7CiAgdGhyb3dfdW5sZXNzKDQyLCBxdWVyeV93YWxsZXRfaWQgPT0gd2FsbGV0X2lkKTsKCiAgaW50IHF1ZXJ5X2lkID0gaW5fbXNnfmxvYWRfdWludCg2NCk7CgogIChpbnQgY250LCBpbnQgYml0cykgPSBjYWxjX2JvY19zaXplKDAsIDAsIGluX21zZyk7CiAgdGhyb3dfaWYoNDAsIChjbnQgPiA4KSB8IChiaXRzID4gMjA0OCkpOwoKICAoc2xpY2UgcXVlcnksIHZhciBmb3VuZD8pID0gcGVuZGluZ19xdWVyaWVzLnVkaWN0X2dldD8oNjQsIHF1ZXJ5X2lkKTsKCiAgaWZub3QgKGZvdW5kPykgewogICAgZmxvb2QgKz0gMTsKICAgIHRocm93X2lmKDM5LCBmbG9vZCA+IDEwKTsKICB9CgogIHZhciBib3VuZCA9IChub3coKSA8PCAzMik7CiAgdGhyb3dfaWYoMzMsIHF1ZXJ5X2lkIDwgYm91bmQpOwoKICAoaW50IGNyZWF0b3JfaSwgaW50IGNudCwgaW50IGNudF9iaXRzLCBzbGljZSBtc2cpID0gdW5wYWNrX3F1ZXJ5X2RhdGEoaW5fbXNnLCBuLCBxdWVyeSwgZm91bmQ/LCByb290X2kpOwogIGludCBtYXNrID0gMSA8PCByb290X2k7CiAgdGhyb3dfaWYoMzQsIGNudF9iaXRzICYgbWFzayk7CiAgY250X2JpdHMgfD0gbWFzazsKICBjbnQgKz0gMTsKCiAgdGhyb3dfaWYoNDEsIH4gZm91bmQ/ICYgKGNudCA8IGspICYgKGJvdW5kICsgKCg2MCAqIDYwKSA8PCAzMikgPiBxdWVyeV9pZCkpOwoKICBzZXRfZ2FzX2xpbWl0KDEwMDAwMCk7CgogIGlmbm90IChmb3VuZD8pIHsKICAgIG93bmVyX2luZm9zfnVkaWN0X3NldF9idWlsZGVyKDgsIHJvb3RfaSwgcGFja19vd25lcl9pbmZvKHB1YmxpY19rZXksIGZsb29kKSk7CiAgfQoKICAocGVuZGluZ19xdWVyaWVzLCBvd25lcl9pbmZvcykgPSB1cGRhdGVfcGVuZGluZ19xdWVyaWVzKHBlbmRpbmdfcXVlcmllcywgb3duZXJfaW5mb3MsIG1zZywgcXVlcnlfaWQsIGNyZWF0b3JfaSwgY250LCBjbnRfYml0cywgbiwgayk7CiAgc2V0X2RhdGEocGFja19zdGF0ZShwZW5kaW5nX3F1ZXJpZXMsIG93bmVyX2luZm9zLCBsYXN0X2NsZWFuZWQsIGssIG4sIHdhbGxldF9pZCkpOwoKICBjb21taXQoKTsKCiAgaW50IG5lZWRfc2F2ZSA9IDA7CiAgaWZub3QgKGNlbGxfbnVsbD8oc2lnbmF0dXJlcykgfCAoY250ID49IGspKSB7CiAgICAoaW50IG5ld19jbnQsIGNudF9iaXRzKSA9IGNoZWNrX3NpZ25hdHVyZXMob3duZXJfaW5mb3MsIHNpZ25hdHVyZXMsIGhhc2gsIGNudF9iaXRzKTsKICAgIGNudCArPSBuZXdfY250OwogICAgKHBlbmRpbmdfcXVlcmllcywgb3duZXJfaW5mb3MpID0gdXBkYXRlX3BlbmRpbmdfcXVlcmllcyhwZW5kaW5nX3F1ZXJpZXMsIG93bmVyX2luZm9zLCBtc2csIHF1ZXJ5X2lkLCBjcmVhdG9yX2ksIGNudCwgY250X2JpdHMsIG4sIGspOwogICAgbmVlZF9zYXZlID0gLTE7CiAgfQoKICBhY2NlcHRfbWVzc2FnZSgpOwogIGJvdW5kIC09ICg2NCA8PCAzMik7ICAgOzsgY2xlYW4gdXAgcmVjb3JkcyBleHBpcmVkIG1vcmUgdGhhbiA2NCBzZWNvbmRzIGFnbwogIGludCBvbGRfbGFzdF9jbGVhbmVkID0gbGFzdF9jbGVhbmVkOwogIGRvIHsKICAgIHZhciAocGVuZGluZ19xdWVyaWVzJywgaSwgcXVlcnksIGYpID0gcGVuZGluZ19xdWVyaWVzLnVkaWN0X2RlbGV0ZV9nZXRfbWluKDY0KTsKICAgIGZ+dG91Y2goKTsKICAgIGlmIChmKSB7CiAgICAgIGYgPSAoaSA8IGJvdW5kKTsKICAgIH0KICAgIGlmIChmKSB7CiAgICAgIGlmIChxdWVyeX5sb2FkX2ludCgxKSkgewogICAgICAgIG93bmVyX2luZm9zfmRlY19mbG9vZChxdWVyeX5sb2FkX3VpbnQoOCkpOwogICAgICB9CiAgICAgIHBlbmRpbmdfcXVlcmllcyA9IHBlbmRpbmdfcXVlcmllcyc7CiAgICAgIGxhc3RfY2xlYW5lZCA9IGk7CiAgICAgIG5lZWRfc2F2ZSA9IC0xOwogICAgfQogIH0gdW50aWwgKH4gZik7CgogIGlmIChuZWVkX3NhdmUpIHsKICAgIHNldF9kYXRhKHBhY2tfc3RhdGUocGVuZGluZ19xdWVyaWVzLCBvd25lcl9pbmZvcywgbGFzdF9jbGVhbmVkLCBrLCBuLCB3YWxsZXRfaWQpKTsKICB9Cn0KCjs7IEdldCBtZXRob2RzCjs7IHJldHVybnMgLTEgZm9yIHByb2Nlc3NlZCBxdWVyaWVzLCAwIGZvciB1bnByb2Nlc3NlZCwgMSBmb3IgdW5rbm93biAoZm9yZ290dGVuKQooaW50LCBpbnQpIGdldF9xdWVyeV9zdGF0ZShpbnQgcXVlcnlfaWQpIG1ldGhvZF9pZCB7CiAgKF8sIGludCBuLCBfLCBpbnQgbGFzdF9jbGVhbmVkLCBfLCBjZWxsIHBlbmRpbmdfcXVlcmllcykgPSB1bnBhY2tfc3RhdGUoKTsKICAoc2xpY2UgY3MsIHZhciBmb3VuZCkgPSBwZW5kaW5nX3F1ZXJpZXMudWRpY3RfZ2V0Pyg2NCwgcXVlcnlfaWQpOwogIGlmIChmb3VuZCkgewogICAgaWYgKGNzfmxvYWRfaW50KDEpKSB7CiAgICAgIGNzfmxvYWRfdWludCg4ICsgOCk7CiAgICAgIHJldHVybiAoMCwgY3N+bG9hZF91aW50KG4pKTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiAoLTEsIDApOwogICAgfQogIH0gIGVsc2UgewogICAgcmV0dXJuICgtKHF1ZXJ5X2lkIDw9IGxhc3RfY2xlYW5lZCksIDApOwogIH0KfQoKaW50IHByb2Nlc3NlZD8oaW50IHF1ZXJ5X2lkKSBtZXRob2RfaWQgewogIChpbnQgeCwgXykgPSBnZXRfcXVlcnlfc3RhdGUocXVlcnlfaWQpOwogIHJldHVybiB4Owp9CgpjZWxsIGNyZWF0ZV9pbml0X3N0YXRlKGludCB3YWxsZXRfaWQsIGludCBuLCBpbnQgaywgY2VsbCBvd25lcnNfaW5mbykgbWV0aG9kX2lkIHsKICByZXR1cm4gcGFja19zdGF0ZShuZXdfZGljdCgpLCBvd25lcnNfaW5mbywgMCwgaywgbiwgd2FsbGV0X2lkKTsKfQoKY2VsbCBtZXJnZV9saXN0KGNlbGwgYSwgY2VsbCBiKSB7CiAgaWYgKGNlbGxfbnVsbD8oYSkpIHsKICAgIHJldHVybiBiOwogIH0KICBpZiAoY2VsbF9udWxsPyhiKSkgewogICAgcmV0dXJuIGE7CiAgfQogIHNsaWNlIGFzID0gYS5iZWdpbl9wYXJzZSgpOwogIGlmIChhcy5zbGljZV9yZWZzKCkgIT0gMCkgewogICAgY2VsbCB0YWlsID0gbWVyZ2VfbGlzdChhc35sb2FkX3JlZigpLCBiKTsKICAgIHJldHVybiBiZWdpbl9jZWxsKCkuc3RvcmVfc2xpY2UoYXMpLnN0b3JlX3JlZih0YWlsKS5lbmRfY2VsbCgpOwogIH0KCiAgYXN+c2tpcF9sYXN0X2JpdHMoMSk7CiAgOzsgYXN+c2tpcF9iaXRzKDEpOwogIHJldHVybiBiZWdpbl9jZWxsKCkuc3RvcmVfc2xpY2UoYXMpLnN0b3JlX2RpY3QoYikuZW5kX2NlbGwoKTsKCn0KCmNlbGwgZ2V0X3B1YmxpY19rZXlzKCkgbWV0aG9kX2lkIHsKICAoXywgXywgXywgXywgY2VsbCBwdWJsaWNfa2V5cywgXykgPSB1bnBhY2tfc3RhdGUoKTsKICByZXR1cm4gcHVibGljX2tleXM7Cn0KCihpbnQsIGludCkgY2hlY2tfcXVlcnlfc2lnbmF0dXJlcyhjZWxsIHF1ZXJ5KSBtZXRob2RfaWQgewogIHNsaWNlIGNzID0gcXVlcnkuYmVnaW5fcGFyc2UoKTsKICBzbGljZSByb290X3NpZ25hdHVyZSA9IGNzfmxvYWRfYml0cyg1MTIpOwogIGludCByb290X2hhc2ggPSBzbGljZV9oYXNoKGNzKTsKICBpbnQgcm9vdF9pID0gY3N+bG9hZF91aW50KDgpOwoKICBjZWxsIHB1YmxpY19rZXlzID0gZ2V0X3B1YmxpY19rZXlzKCk7CiAgKHNsaWNlIHB1YmxpY19rZXksIHZhciBmb3VuZD8pID0gcHVibGljX2tleXMudWRpY3RfZ2V0Pyg4LCByb290X2kpOwogIHRocm93X3VubGVzcygzMSwgZm91bmQ/KTsKICB0aHJvd191bmxlc3MoMzIsIGNoZWNrX3NpZ25hdHVyZShyb290X2hhc2gsIHJvb3Rfc2lnbmF0dXJlLCBwdWJsaWNfa2V5LnByZWxvYWRfdWludCgyNTYpKSk7CgogIGludCBtYXNrID0gMSA8PCByb290X2k7CgogIGNlbGwgc2lnbmF0dXJlcyA9IGNzfmxvYWRfZGljdCgpOwogIGlmIChjZWxsX251bGw/KHNpZ25hdHVyZXMpKSB7CiAgICByZXR1cm4gKDEsIG1hc2spOwogIH0KICAoaW50IGNudCwgbWFzaykgPSBjaGVja19zaWduYXR1cmVzKHB1YmxpY19rZXlzLCBzaWduYXR1cmVzLCBzbGljZV9oYXNoKGNzKSwgbWFzayk7CiAgcmV0dXJuIChjbnQgKyAxLCBtYXNrKTsKfQoKY2VsbCBtZXNzYWdlc19ieV9tYXNrKGludCBtYXNrLCBpbnQgaW52KSBtZXRob2RfaWQgewogIChfLCBpbnQgbiwgXywgXywgXywgY2VsbCBwZW5kaW5nX3F1ZXJpZXMpID0gdW5wYWNrX3N0YXRlKCk7CiAgaW50IGkgPSAtMTsKICBjZWxsIGEgPSBuZXdfZGljdCgpOwogIGRvIHsKICAgIChpLCB2YXIgY3MsIHZhciBmKSA9IHBlbmRpbmdfcXVlcmllcy51ZGljdF9nZXRfbmV4dD8oNjQsIGkpOwogICAgaWYgKGYpIHsKICAgICAgaWYgKGNzfmxvYWRfaW50KDEpKSB7CiAgICAgICAgaW50IGNudF9iaXRzID0gY3Muc2tpcF9iaXRzKDggKyA4KS5wcmVsb2FkX3VpbnQobikgXiBpbnY7CiAgICAgICAgaWYgKGNudF9iaXRzICYgbWFzaykgewogICAgICAgICAgYX51ZGljdF9zZXRfYnVpbGRlcig2NCwgaSwgYmVnaW5fY2VsbCgpLnN0b3JlX3NsaWNlKGNzKSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSB1bnRpbCAofiBmKTsKICByZXR1cm4gYTsKfQoKY2VsbCBnZXRfbWVzc2FnZXNfc2lnbmVkX2J5X2lkKGludCBpZCkgbWV0aG9kX2lkIHsKICByZXR1cm4gbWVzc2FnZXNfYnlfbWFzaygxIDw8IGlkLCAwKTsKfQoKY2VsbCBnZXRfbWVzc2FnZXNfdW5zaWduZWRfYnlfaWQoaW50IGlkKSBtZXRob2RfaWQgewogIHJldHVybiBtZXNzYWdlc19ieV9tYXNrKDEgPDwgaWQsIH4gMCk7Cn0KCmNlbGwgZ2V0X21lc3NhZ2VzX3Vuc2lnbmVkKCkgbWV0aG9kX2lkIHsKICByZXR1cm4gbWVzc2FnZXNfYnlfbWFzayh+IDAsIDApOwp9CgooaW50LCBpbnQpIGdldF9uX2soKSBtZXRob2RfaWQgewogIChfLCBpbnQgbiwgaW50IGssIF8sIF8sIF8pID0gdW5wYWNrX3N0YXRlKCk7CiAgcmV0dXJuIChuLCBrKTsKfQoKY2VsbCBtZXJnZV9pbm5lcl9xdWVyaWVzKGNlbGwgYSwgY2VsbCBiKSBtZXRob2RfaWQgewogIHNsaWNlIGNhID0gYS5iZWdpbl9wYXJzZSgpOwogIHNsaWNlIGNiID0gYi5iZWdpbl9wYXJzZSgpOwogIGNlbGwgbGlzdF9hID0gY2F+bG9hZF9kaWN0KCk7CiAgY2VsbCBsaXN0X2IgPSBjYn5sb2FkX2RpY3QoKTsKICB0aHJvd191bmxlc3MoMzEsIHNsaWNlX2hhc2goY2EpID09IHNsaWNlX2hhc2goY2IpKTsKICByZXR1cm4gYmVnaW5fY2VsbCgpCiAgICAuc3RvcmVfZGljdChtZXJnZV9saXN0KGxpc3RfYSwgbGlzdF9iKSkKICAgIC5zdG9yZV9zbGljZShjYSkKICAuZW5kX2NlbGwoKTsKfQ==";

describe("Exit code parser", () => {
  it("parses the exit code", () => {
    const exitCodes = parseExitCodes(Buffer.from(code, "base64").toString());
    expect(exitCodes).toEqual([16]);
  });
});
